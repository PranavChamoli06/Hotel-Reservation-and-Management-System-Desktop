-- ===================================================================
-- DROP & CREATE DATABASE
-- ===================================================================
DROP DATABASE IF EXISTS hotel_db;
CREATE DATABASE hotel_db;
USE hotel_db;

-- ===================================================================
-- USERS TABLE (SECURE + ROLES)
-- ===================================================================
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    role ENUM('admin','manager','staff','user') DEFAULT 'user',

    salt VARCHAR(64) NOT NULL,
    password_hash VARCHAR(64) NOT NULL
);

-- ===================================================================
-- ROOMS TABLE (BASED ON PROJECT REQUIREMENTS)
-- Standard : 100–150
-- Deluxe   : 200–250
-- Suite    : 300–350
-- ===================================================================
CREATE TABLE rooms (
    room_number INT PRIMARY KEY,
    room_type ENUM('Standard', 'Deluxe', 'Suite') NOT NULL
);

-- Standard Rooms: 100–150
INSERT INTO rooms (room_number, room_type)
SELECT n, 'Standard'
FROM (
    SELECT 100 + seq AS n
    FROM (
        SELECT 0 seq UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION
        SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION
        SELECT 10 UNION SELECT 11 UNION SELECT 12 UNION SELECT 13 UNION SELECT 14 UNION
        SELECT 15 UNION SELECT 16 UNION SELECT 17 UNION SELECT 18 UNION SELECT 19 UNION
        SELECT 20 UNION SELECT 21 UNION SELECT 22 UNION SELECT 23 UNION SELECT 24 UNION
        SELECT 25 UNION SELECT 26 UNION SELECT 27 UNION SELECT 28 UNION SELECT 29 UNION
        SELECT 30 UNION SELECT 31 UNION SELECT 32 UNION SELECT 33 UNION SELECT 34 UNION
        SELECT 35 UNION SELECT 36 UNION SELECT 37 UNION SELECT 38 UNION SELECT 39 UNION
        SELECT 40 UNION SELECT 41 UNION SELECT 42 UNION SELECT 43 UNION SELECT 44 UNION
        SELECT 45 UNION SELECT 46 UNION SELECT 47 UNION SELECT 48 UNION SELECT 49 UNION
        SELECT 50
    ) AS t
) AS r;

-- Deluxe Rooms: 200–250
INSERT INTO rooms (room_number, room_type)
SELECT n, 'Deluxe'
FROM (
    SELECT 200 + seq AS n
    FROM (
        SELECT 0 seq UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION
        SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION
        SELECT 10 UNION SELECT 11 UNION SELECT 12 UNION SELECT 13 UNION SELECT 14 UNION
        SELECT 15 UNION SELECT 16 UNION SELECT 17 UNION SELECT 18 UNION SELECT 19 UNION
        SELECT 20 UNION SELECT 21 UNION SELECT 22 UNION SELECT 23 UNION SELECT 24 UNION
        SELECT 25 UNION SELECT 26 UNION SELECT 27 UNION SELECT 28 UNION SELECT 29 UNION
        SELECT 30 UNION SELECT 31 UNION SELECT 32 UNION SELECT 33 UNION SELECT 34 UNION
        SELECT 35 UNION SELECT 36 UNION SELECT 37 UNION SELECT 38 UNION SELECT 39 UNION
        SELECT 40 UNION SELECT 41 UNION SELECT 42 UNION SELECT 43 UNION SELECT 44 UNION
        SELECT 45 UNION SELECT 46 UNION SELECT 47 UNION SELECT 48 UNION SELECT 49 UNION
        SELECT 50
    ) AS t
) AS r;

-- Suite Rooms: 300–350
INSERT INTO rooms (room_number, room_type)
SELECT n, 'Suite'
FROM (
    SELECT 300 + seq AS n
    FROM (
        SELECT 0 seq UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION
        SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION
        SELECT 10 UNION SELECT 11 UNION SELECT 12 UNION SELECT 13 UNION SELECT 14 UNION
        SELECT 15 UNION SELECT 16 UNION SELECT 17 UNION SELECT 18 UNION SELECT 19 UNION
        SELECT 20 UNION SELECT 21 UNION SELECT 22 UNION SELECT 23 UNION SELECT 24 UNION
        SELECT 25 UNION SELECT 26 UNION SELECT 27 UNION SELECT 28 UNION SELECT 29 UNION
        SELECT 30 UNION SELECT 31 UNION SELECT 32 UNION SELECT 33 UNION SELECT 34 UNION
        SELECT 35 UNION SELECT 36 UNION SELECT 37 UNION SELECT 38 UNION SELECT 39 UNION
        SELECT 40 UNION SELECT 41 UNION SELECT 42 UNION SELECT 43 UNION SELECT 44 UNION
        SELECT 45 UNION SELECT 46 UNION SELECT 47 UNION SELECT 48 UNION SELECT 49 UNION
        SELECT 50
    ) AS t
) AS r;

-- ===================================================================
-- RESERVATIONS TABLE
-- ===================================================================
CREATE TABLE reservations (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    guest_name VARCHAR(100) NOT NULL,
    room_number INT NOT NULL,
    room_type VARCHAR(50) NOT NULL,

    check_in DATE NOT NULL,
    check_out DATE NOT NULL,

    phone_number VARCHAR(15) NOT NULL,

    status ENUM('Pending','Confirmed','Checked-In','Checked-Out','Cancelled','No-Show')
        DEFAULT 'Pending',

    total_price DECIMAL(10,2) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (room_number) REFERENCES rooms(room_number) ON DELETE RESTRICT
);

-- ===================================================================
-- SECURE SEEDED USERS (HASHED PASSWORDS)
-- These values match your Java BCrypt/SHA-256 logic
-- ===================================================================
INSERT INTO users (username, role, salt, password_hash) VALUES
('admin', 'admin',
 'e1ce54b21783b48d5bd1a16467f1d8e22611cc6885239deb0fa0ff3ae6d941d6',
 'f5a5f85a1c913e9503e17f1595ee2cda7a971927f38db4a8624046425241e564'),

('manager1', 'manager',
 '98fa06deeb266bd52d77a8d937686e6b992c7b44376da4cf79fae16fb1156a9a',
 'ec742d49e6bbbe6184a5c90eb40beb8fb2ee395dc945e5b548b7610c9a3e7c21'),

('staff1', 'staff',
 '98e0a7104bf35638ff7a628f210a43f1c4168cb7d4acb08181a052562e48fe23',
 '21e7844cd44fcc815317e9909179ef8b9e34add485e03d4c37bb2bd2a873e2f1'),

('user1', 'user',
 '49f1532256e70dbc2ee27c66907bac1d6efb754d1c3f6a55cd77c772226f98f3',
 '90a437c93eb5ad5570c30977ae863574b990ccd7f69fb7180285d0ebc6633a56');